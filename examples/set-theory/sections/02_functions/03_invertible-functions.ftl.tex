\documentclass[../../set-theory.ftl.tex]{subfiles}

\begin{document}
  \section{Invertible functions}

  \begin{forthel}
    [readtex \path{set-theory/sections/02_functions/02_image-and-preimage.ftl.tex}]
  \end{forthel}

  \begin{forthel}
    Let $u,v,w$ denote objects.
    Let $x,y,z$ denote sets.
    Let $f,g,h$ denote functions.
  \end{forthel}


  \subsection{Definitions and basic properties}

  We call a function $f$ \textit{invertible} if there is a function $g$ that
  undoes the operation of $f$, i.e. applying $f$ after $g$ and applying $g$
  after $f$ each results in the identity function.

  \begin{forthel}
    \begin{definition}
      An inverse of $f$ is a function $g$ from $\range(f)$ to $\dom(f)$ such that \[ f(u) = v \iff g(v) = u \] for all $u \in \dom(f)$ and all $v \in \dom(g)$.
    \end{definition}

    \begin{definition}
      $f$ is invertible iff $f$ has an inverse.
    \end{definition}

    \begin{lemma}
      Let $g,g'$ be inverses of $f$.
      Then $g = g'$.
    \end{lemma}
    \begin{proof}
      We have $\dom(g) = \range(f) = \dom(g')$.

      Let us show that $g(v) = g'(v)$ for all $v \in \range(f)$.
        Let $v \in \range(f)$.
        Take $u = g'(v)$.
        Then $g(v) = u$ iff $f(u) = v$.
        We have $f(u) = v$ iff $g'(v) = u$.
        Thus $g(v) = g'(v)$.
      End.

      Hence the thesis (by \nameref{SetTheory_02_01_200419}).
      Indeed $\dom(g) = \dom(g')$.
    \end{proof}

    \begin{definition}
      Let $f$ be invertible.
      $f^{-1}$ is the inverse of $f$.
    \end{definition}

    Let $f$ is involutory stand for $f$ is the inverse of $f$.
    Let $f$ is selfinverse stand for $f$ is the inverse of $f$.

    \begin{proposition}\label{SetTheory_02_03_587168}
      Let $f$ be a function from $x$ onto $y$ and $g$ be a function from $y$ onto $x$.
      Then $g$ is the inverse of $f$ iff $g \circ f = \id_{x}$ and $f \circ g = \id_{y}$.
    \end{proposition}
    \begin{proof}
      Case $g$ is the inverse of $f$.
        We have $\dom(g \circ f) = \dom(f) = x = \dom(\id_{x})$.
        For all $u \in x$ we have $(g \circ f)(u) = g(f(u)) = u$.
        Hence $g \circ f = \id_{x}$.

        We have $\dom(f \circ g) = \dom(g) = y = \dom(\id_{y})$.
        For all $v \in y$ we have $(f \circ g)(v) = f(g(v)) = v$.
        Hence $f \circ g = \id_{y}$.
      End.

      Case $g \circ f = \id_{x}$ and $f \circ g = \id_{y}$.
        Then $\dom(g) = y = \range(f)$ and $\range(g) = x = \dom(f)$.
        Let $u \in \dom(f)$ and $v \in \dom(g)$.
        If $f(u) = v$ then $g(v) = g(f(u)) = (g \circ f)(u) = \id_{x}(u) = u$.
        If $g(v) = u$ then $f(u) = f(g(v)) = (f \circ g)(v) = \id_{y}(v) = v$.
        Hence $f(u) = v$ iff $g(v) = u$.
      End.
    \end{proof}

    \begin{proposition}\label{SetTheory_02_03_196251}
      Let $f$ be an invertible function from $x$ onto $y$.
      Then $f^{-1}$ is an invertible function from $y$ onto $x$ such that $(f^{-1})^{-1} = f$.
    \end{proposition}
    \begin{proof}
      $f^{-1}$ is a function from $y$ to $x$.
      Indeed $\range(f) = y$ and $\dom(f) = x$.
      $f^{-1}$ is a function onto $x$.
      Indeed for any $u \in x$ we have $f^{-1}(f(u)) = u$.
      $f^{-1}$ is the inverse of $f$.
      Thus $f \circ f^{-1} = \id_{y}$ and $f^{-1} \circ f = \id_{x}$.
      Therefore $f$ is the inverse of $f^{-1}$ (by \ref{SetTheory_02_03_587168}).
    \end{proof}

    \begin{proposition}\label{SetTheory_02_03_601485}
      Let $f$ be an invertible function from $x$ onto $y$.
      Then $f \circ f^{-1} = \id_{y}$ and $f^{-1} \circ f = \id_{x}$.
    \end{proposition}
    \begin{proof}
      $f^{-1}$ is a function from $y$ onto $x$ (by \ref{SetTheory_02_03_196251}).
      $f^{-1}$ is the inverse of $f$.
      Hence the thesis (by \ref{SetTheory_02_03_587168}).
    \end{proof}

    \begin{proposition}\label{SetTheory_02_03_173329}
      Let $f$ be an invertible function from $x$ onto $y$.
      Then ($f^{-1}(f(u)) = u$ for all $u \in x$) and ($f(f^{-1}(v)) = v$ for all $v \in y$).
    \end{proposition}
    \begin{proof}
      Let us show that  $f^{-1}(f(u)) = u$ for all $u \in x$.
        Let $u \in x$.
        Then $f^{-1}(f(u)) = (f^{-1} \circ f)(u) = \id_{x}(u) = u$.
      End.

      Let us show that $f(f^{-1}(v)) = v$ for all $v \in y$.
        Let $v \in y$.
        Then $f(f^{-1}(v)) = (f \circ f^{-1})(v) = \id_{y}(v) = v$.
      End.
    \end{proof}

    \begin{proposition}\label{SetTheory_02_03_430030}
      Let $f$ be an invertible function from $x$ onto $y$ and $g$ be an invertible function from $y$ onto $z$.
      Then $g \circ f$ is invertible and $(g \circ f)^{-1} = f^{-1} \circ g^{-1}$.
    \end{proposition}
    \begin{proof}
      $f^{-1}$ is a function from $y$ onto $x$.
      $g^{-1}$ is a function from $z$ onto $y$.
      Take $h = f^{-1} \circ g^{-1}$.
      [prover vampire] % No clue why, but E cannot prove this
      Then $h$ is a function from $z$ onto $x$ (by \ref{SetTheory_02_01_205975}).
      [prover eprover]
      $g \circ f$ is a function from $x$ to $z$.

      Let us show that $((g \circ f) \circ h) = \id_{z}$.
        We have $f \circ (f^{-1} \circ g^{-1}) = (f \circ f^{-1}) \circ g^{-1}$ (by \nameref{SetTheory_02_01_200419}).
        Indeed $f \circ (f^{-1} \circ g^{-1})$ and $(f \circ f^{-1}) \circ g^{-1}$ are functions of $z$.
        $f \circ h$ is a function from $z$ to $y$.
        Hence
        \[   (g \circ f) \circ h \]
        \[ = g \circ (f \circ h) \]
        \[ = g \circ (f \circ (f^{-1} \circ g^{-1})) \]
        \[ = g \circ ((f \circ f^{-1}) \circ g^{-1}) \]
        \[ = g \circ (\id_{y} \circ g^{-1}) \]
        \[ = g \circ g^{-1} \]
        \[ = \id_{z}. \]
      End.

      Let us show that $h \circ (g \circ f) = \id_{x}$.
        We have $(f^{-1} \circ g^{-1}) \circ g = f^{-1} \circ (g^{-1} \circ g)$ (by \nameref{SetTheory_02_01_200419}).
        $g \circ f$ is a function from $x$ to $z$.
        Hence
        \[   h \circ (g \circ f) \]
        \[ = (h \circ g) \circ f \]
        \[ = ((f^{-1} \circ g^{-1}) \circ g) \circ f \]
        \[ = (f^{-1} \circ (g^{-1} \circ g)) \circ f \]
        \[ = (f^{-1} \circ \id_{y}) \circ f \]
        \[ = f^{-1} \circ f \]
        \[ = \id_{x}. \]
      End.

      Thus $h$ is the inverse of $g \circ f$ (by \ref{SetTheory_02_03_587168}).
      Indeed $g \circ f$ is a function from $x$ onto $z$ and $h$ is a function from $z$ onto $x$.
    \end{proof}

    \begin{proposition}\label{SetTheory_02_03_908585}
      Let $f$ be an invertible function from $x$ onto $y$ and $a \subseteq x$.
      Then $f \restr a$ is invertible and $(f\restr a)^{-1} = f^{-1} \restr f[a]$.
    \end{proposition}
    \begin{proof}
      $f \restr a$ is a function from $a$ onto $f[a]$.
      Take $g = f^{-1} \restr f[a]$.
      Then $g$ is a function of $f[a]$.

      Let us show that $a \subseteq \range(g)$.
        Let $u \in a$.
        Then $f(u) \in f[a]$.
        Hence $g(f(u)) = f^{-1}(f(u)) = u$.
        Thus $u$ is a value of $g$.
      End.

      Let us show that $\range(g) \subseteq a$.
        Let $u \in \range(g)$.
        Take $v \in f[a]$ such that $u = g(v)$.
        Take $w \in a$ such that $v = f(w)$.
        Then $u = (f^{-1} \restr f[a])(v) = f^{-1}(v) = f^{-1}(f(w)) = w$.
        Hence $u \in a$.
      End.

      Hence $\range(g) = a$.
      Thus $g$ is a function onto $a$.

      Let us show that $g((f \restr a)(u)) = u$ for all $u \in a$.
        Let $u \in a$.
        Then $g((f \restr a)(u)) = g(f(u)) = (f^{-1} \restr f[a])(f(u)) = f^{-1}(f(u)) = u$.
      End.

      Let us show that $((f \restr a)(g(v))) = v$ for all $v \in f[a]$.
        Let $v \in f[a]$.
        Take $u \in a$ such that $v = f(u)$.
        We have $g(v) = g(f(u)) = (f^{-1} \restr f[a])(f(u)) = f^{-1}(f(u)) = u$.
        Hence $(f \restr a)(g(v)) = (f \restr a)(u) = f(u) = v$.
      End.

      Thus $g \circ (f \restr a) = \id_{a}$ and $(f \restr a) \circ g = \id_{f[a]}$.
      Therefore $g$ is the inverse of $f \restr a$.
    \end{proof}

    \begin{proposition}\label{SetTheory_02_03_293037}
      Let $f$ be an invertible function from $x$ onto $y$ and $b \subseteq y$.
      Then $f^{-}[b] = f^{-1}[b]$.
    \end{proposition}
    \begin{proof}
      We have $f^{-1}[b] = \class{f^{-1}(v) | v \in b}$ and $f^{-}[b] = \class{u \in x | f(u) \in b}$.

      Let us show that $f^{-}[b] \subseteq f^{-1}[b]$.
        Let $u \in f^{-}[b]$.
        Take $v \in b$ such that $v = f(u)$.
        Then $f^{-1}(v) = f^{-1}(f(u)) = u$.
        Hence $u \in f^{-1}[b]$.
      End.

      Let us show that $f^{-1}[b] \subseteq f^{-}[b]$.
        Let $u \in f^{-1}[b]$.
        Take $v \in b$ such that $u = f^{-1}(v)$.
        Then $f(u) = f(f^{-1}(v)) = v$.
        Hence $u \in f^{-}[b]$.
      End.
    \end{proof}

    \begin{corollary}\label{SetTheory_02_03_265073}
      Let $f$ be an invertible function from $x$ onto $y$ and $v \in y$.
      Then $f^{-}[\set{v}] = \set{f^{-1}(v)}$.
    \end{corollary}
    \begin{proof}
      $f^{-}[\set{v}] = f^{-1}[\set{v}]$.
      We have $f^{-1}[\set{v}] = \class{f^{-1}(w) | w \in \set{v}}$.
      Hence $f^{-1}[\set{v}] = \set{f^{-1}(v)}$.
    \end{proof}

    \begin{proposition}\label{SetTheory_02_03_394829}
      Let $f$ be a function from $x$ onto $y$.
      $f$ is invertible iff $f$ is one to one.
    \end{proposition}
    \begin{proof}
      Case $f$ is invertible.
        Let $u,v \in x$.
        Assume $f(u) = f(v)$.
        Then $u = f^{-1}(f(u)) = f^{-1}(f(v)) = v$.
      End.

      Case $f$ is one to one.
        Define $g(v) = $ choose $u \in x$ such that $f(u) = v$ in $u$ for $v \in y$.
        $g$ is a function from $y$ to $x$.
        For all $v \in y$ and all $u,u' \in x$ such that $f(u) = v = f(u')$ we have $u = u'$.
        Hence $g$ is a function from $y$ onto $x$.
        For all $u \in x$ we have $g(f(u)) = u$.
        For all $v \in y$ we have $f(g(v)) = v$.
        Hence $g$ is the inverse of $f$.
      End.
    \end{proof}

    \begin{corollary}\label{SetTheory_02_03_187673}
      Let $f$ be an invertible function from $x$ onto $y$.
      Then $f^{-1}$ is a bijection between $y$ and $x$.
    \end{corollary}
    \begin{proof}
      $f^{-1}$ is a function from $y$ onto $x$.
      $f^{-1}$ is invertible.
      Hence $f^{-1}$ is one to one.
      Thus $f^{-1}$ is a function from $y$ into $x$.
      Therefore $f^{-1}$ is a bijection between $y$ and $x$.
    \end{proof}
  \end{forthel}


  \subsection{Involutions}

  A special case of invertible functions are \textit{involutions}, i.e.
  functions which are self-inverse on their domain.

  \begin{forthel}
    \begin{definition}
      An involution on $x$ is a selfinverse function $f$ on $x$.
    \end{definition}

    \begin{proposition}\label{SetTheory_02_03_305935}
      $\id_{x}$ is an involution on $x$.
    \end{proposition}
    \begin{proof}
      $\id_{x}$ is a function on $x$.
      We have $\id_{x} \circ \id_{x} = \id_{x}$.
      Hence $\id_{x}$ is selfinverse.
    \end{proof}

    \begin{proposition}\label{SetTheory_02_03_610247}
      Let $f$ and $g$ be involutions on $x$.
      Then $g \circ f$ is an involution on $x$ iff $g \circ f = f \circ g$.
    \end{proposition}
    \begin{proof}
      Case $g \circ f$ is an involution on $x$.
        Then $(g \circ f)^{-1} = f^{-1} \circ g^{-1} = f \circ g$.
      End.

      Case $g \circ f = f \circ g$.
        $f \circ f$, $f \circ g$ and $f \circ g$ are functions on $x$.
        Hence
        \[   (g \circ f) \circ (g \circ f) \]
        \[ = (g \circ f) \circ (f \circ g) \]
        \[ = ((g \circ f) \circ f) \circ g \]
        \[ = (g \circ (f \circ f)) \circ g \]
        \[ = (g \circ \id_{x}) \circ g \]
        \[ = g \circ g \]
        \[ = \id_{x}. \]
        Thus $g \circ f$ is selfinverse.
      End.
    \end{proof}

    \begin{corollary}\label{SetTheory_02_03_310947}
      Let $f$ be an involutions on $x$.
      Then $f \circ f$ is an involution on $x$.
    \end{corollary}

    \begin{proposition}\label{SetTheory_02_03_280184}
      Let $f$ be an involution on $x$.
      Then $f$ is a permutation of $x$.
    \end{proposition}
    \begin{proof}
      $f$ is an invertible function from $x$ onto $x$.
      Hence $f$ is a bijection between $x$ and $x$.
      Thus $f$ is a permutation of $x$.
    \end{proof}
  \end{forthel}
\end{document}
